<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Detergent Concentration Tool</title>

  <meta name="theme-color" content="#0a84ff">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="apple-touch-icon" href="./icons/icon-192.png">
  <link rel="manifest" href="./manifest.webmanifest">

  <style>
    :root{
      --gap:16px; --radius:14px; --tap:48px;
      --accent:#0a84ff; --bg:#f6f7f9; --text:#101114;
    }
    html,body{height:100%}
    body{
      margin:0;
      padding: calc(env(safe-area-inset-top) + 16px)
               calc(env(safe-area-inset-right) + 16px)
               calc(env(safe-area-inset-bottom) + 16px)
               calc(env(safe-area-inset-left) + 16px);
      background:var(--bg); color:var(--text);
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
      -webkit-tap-highlight-color:transparent;
    }
    .wrap{max-width:720px;margin:0 auto;display:flex;flex-direction:column;gap:16px}
    .card{background:#fff;border-radius:var(--radius);box-shadow:0 6px 24px rgba(0,0,0,.06);padding:16px}
    input,select,button{font-size:16px;line-height:1.3;height:var(--tap);padding:0 12px;border-radius:12px;border:1px solid #dfe3e8;width:100%;box-sizing:border-box}
    button.primary{background:var(--accent);color:#fff;border:none;font-weight:600}
    .sticky-cta{position:sticky;bottom:0;inset-inline:0;padding-top:12px;background:linear-gradient(180deg,rgba(246,247,249,0) 0%, var(--bg) 60%)}
    @media (prefers-reduced-motion: reduce){*{animation:none!important;transition:none!important}}
    :focus-visible{outline:3px solid rgba(10,132,255,.4);outline-offset:2px;border-radius:10px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1 style="margin:0 0 8px 0;">Detergent Concentration Tool</h1>
      <p style="margin:0 0 12px 0;opacity:.75">Quick drop-count â†’ g/L lookup that works offline.</p>

      <!-- 
        TODO: Insert your existing calculator UI and logic below.
        If you already have a full HTML, replace this entire body with your content.
      -->
      <label>Drop count
        <input id="drops" type="number" inputmode="decimal" min="0" step="1" placeholder="e.g., 12">
      </label>
      <label style="margin-top:8px;display:block">Sample volume (mL)
        <input id="volume" type="number" inputmode="decimal" min="1" step="1" placeholder="e.g., 10">
      </label>

      <div class="sticky-cta">
        <button class="primary" id="calcBtn">Calculate</button>
      </div>

      <output id="result" aria-live="polite" style="display:block;margin-top:12px;font-weight:600"></output>
    </div>
  </div>

  <script>
  // Simple example calc; replace with your real formula
  document.getElementById('calcBtn').addEventListener('click', () => {
    const drops = parseFloat(document.getElementById('drops').value || '0');
    const vol = parseFloat(document.getElementById('volume').value || '1');
    if (vol <= 0) return;
    const gPerL = (drops / vol) * 10; // placeholder calculation
    document.getElementById('result').textContent = isFinite(gPerL) ? (gPerL.toFixed(2) + ' g/L') : '';
  });

  // Persist common fields for convenience
  ['drops','volume'].forEach(id => {
    const el = document.getElementById(id);
    const key = 'xref:'+id;
    const val = localStorage.getItem(key);
    if (val !== null) el.value = val;
    el.addEventListener('input', () => localStorage.setItem(key, el.value));
  });
  </script>

  <!-- Service worker register -->
  <script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('./service-worker.js')
        .catch(err => console.error('SW registration failed:', err));
    });
    navigator.serviceWorker.addEventListener('message', (e) => {
      if (e.data && e.data.type === 'SW_READY') {
        console.log('App updated. Refresh to use the latest.');
      }
    });
  }
  </script>

  <!-- Network status banner (no install banner) -->
  <script>
  function showNetBanner(online) {
    let n = document.getElementById('netBanner');
    if (!n) {
      n = document.createElement('div');
      n.id = 'netBanner';
      n.style.cssText = 'position:fixed;left:16px;right:16px;top:16px;z-index:9999;padding:10px 12px;border-radius:12px;text-align:center;font-weight:600';
      document.body.append(n);
    }
    n.textContent = online ? 'Back online' : 'Offline mode';
    n.style.background = online ? '#12b886' : '#ffcc00';
    n.style.color = online ? '#fff' : '#222';
    n.style.opacity = '1';
    clearTimeout(n._t);
    n._t = setTimeout(() => n.style.opacity = '0', 2000);
  }
  window.addEventListener('online',  () => showNetBanner(true));
  window.addEventListener('offline', () => showNetBanner(false));
  if (!navigator.onLine) showNetBanner(false);
  </script>
</body>
</html>
